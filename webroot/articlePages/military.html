<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>个人博客</title>
  <meta name="keywords" content="HC的博客" />
  <meta name="description" content="如影随形主题的个人博客" />
  <link rel="shortcut icon" type="image/x-icon" href="../images/favicon.ico" media="screen" />

  <link href="../css/base.css" rel="stylesheet">
  <link href="../css/rightside.css" rel="stylesheet">
  <link href="../css/style.css" rel="stylesheet">
  <link href="../css/media.css" rel="stylesheet">
  <link href="../css/index/login.css" rel="stylesheet">
  <link href="../css/index/regist.css" rel="stylesheet">
  <link href="../css/life/lifepages.css" rel="stylesheet">
  <link href="../css/index/index.css" rel="stylesheet">

  <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
  <!--[if lt IE 9]>
<script src="js/modernizr.js"></script>
<![endif]-->
  <!--jquery-->
  <script src="../js/jquery.js"></script>
  <!--cookie-->
  <script src="../js/tools/jquery.cookie.js"></script>
  <!--global-->
  <script src="../js/tools/global.js"></script>
  <!--bkframe-->
  <script src="../js/tools/bkframe.js"></script>
  <!--layout-->
  <script src="../js/tools/layout.js"></script>
  <!--cookie-->
  <script src="../js/tools/cookie.js"></script>
  <!--登录-->
  <script src="../js/login.js"></script>
  <!--验证码-->
  <script src="../js/tools/code.js"></script>
  <!--验证客户端-->
  <script src="../js/tools/client.js"></script>
  <!--弹出框-->
  <script src="https://cdn.bootcss.com/toastr.js/latest/toastr.min.js"></script>
  <script src="../js/tools/toastrConfig.js"></script>
  <!--生成时间-->
  <script src="../js/tools/time.js"></script>
  <!--跳转-->
  <script src="../js/tools/localUrl.js"></script>
  <!--qq登录-->
  <script type="text/javascript" src="http://qzonestyle.gtimg.cn/qzone/openapi/qc_loader.js" data-appid="100330589" data-redirecturi=""
    charset="utf-8"></script>
  <!-- 小图标 -->
  <script src="https://use.fontawesome.com/55b5a1fcdd.js"></script>
</head>

<body>
  <!-- 标题栏 -->
  <div class="topnav">
    <!--站内搜索-->
    <div class="search">
      <form target="_blank" class="form" action="http://zhannei.baidu.com/cse/site">
        <input type="text" class="text" name="q" size="30">
        <input type="submit" class="submit" value="搜索">
        <input type="hidden" name="cc" value="hcdast.com">
      </form>
    </div>
    <!--登录注册模块-->
    <div id="login-regist" class="login-regist" style="display: block">
      <!--注册-->
      <div class="regist">
        <button class="regist-btn" onclick="enterRegist()">注册</button>
      </div>
      <!--登录-->
      <div class="login">
        <button class="login-btn" onclick="enterLogin()">登陆</button>
      </div>
    </div>
    <!-- QQ登陆信息模块-->
    <div id="QQloginStatu" class="QQloginStatu">
    </div>
    <!--退出-->
    <div class="blogLoginStatu" id="blogLoginStatu">
    </div>
  </div>
  <!--登录注册-->
  <div id="back">
    <div class="boxLogin" id="login">
      <div class="login5">
        <h2>用户||管理员——登录</h2>
        <a onclick="closeLogin()"></a>
        <!--╳-->
      </div>
      <div class="login51">
        <div class="login5left">
          <span></span>
          <!-- 账号-->
          <div class="login5left1">
            <i class="fa fa-user fa-2x" aria-hidden="true"></i>
            </i>
            <input type="text" id="user" placeholder="用户名" />
          </div>
          <!-- 密码-->
          <div class="login5left1">
            <i class="fa fa-lock fa-2x" aria-hidden="true"></i>
            <input type="password" id="psd" placeholder="密码" />
          </div>
          <!--验证码 -->
          <div class="login5left1">
            <i class="fa fa-qrcode fa-2x " aria-hidden="true"></i>
            <input type="text" class="ipt_vry" name="ipt_vry" placeholder="验证码" />
            <input type="button" id='l_checkCode' class="pro_vry" name="pro_vry" value="" onclick="initCode()">
          </div>
          <div class="isadmin">
            <input type="radio" name="identity" value="4" checked="checked">普通用户
            <!-- <input type="radio" name="identity" value="3"  >测试用户 -->
            <input type="radio" name="identity" value="2">博主
            <input type="radio" name="identity" value="1">管理员
            <!-- <input type="radio" name="identity" value="0">超级管理员 -->
          </div>
          <!-- 登录-->
          <div class="login5left2">
            <button class="dl" onclick="login()">登录</button>
            <a style="cursor: pointer" class="wjmm" onclick="getPassword()">忘记密码？</a>
          </div>
        </div>
        <div class="login5right">
          <span></span>
          <div class="login5right1">
            <a class="sjdl">手机短信登录</a>
          </div>
          <div class="login5right2">
            没有账号？
            <a style="cursor: pointer" class="zcdl" onclick="enterRegist()">快速注册</a>
          </div>
          <div class="login5right3">
            <b class="found"></b>合作账号登录
            <b class="back"></b>
          </div>
          <div class="login5right4">
            <!--<div class="qq" onclick="qqLogin()">-->
            <!--<img src="image/bt_92X120.png" id="qqLoginBtn" >-->
            <!--</div>-->
            <!--<a class="wb">微信</a>-->
            <span id="qqLoginBtn"></span>
            <script type="text/javascript">
              otherLogin();
            </script>
          </div>
        </div>
      </div>
    </div>

    <div class="boxRegist" id="regist">
      <div class="regist5">
        <h2>用户——注册</h2>
        <a onclick="closeRegist()"></a>
        <!--╳-->
      </div>
      <div class="regist51">
        <div name="regist5form">
          <div class="regist5left">
            <span></span>
            <!-- 账号-->
            <div class="regist5left1">
              <label> 用户名：</label>
              <input type="text" id="username" placeholder="用户名" />
            </div>
            <!-- 密码-->
            <div class="regist5left1">
              <label> 密 码：</label>
              <input type="password" id="password" placeholder="密码" />
            </div>
            <div class="regist5left1">
              <label> 邮 箱：</label>
              <input type="text" id="email" placeholder="邮箱" />
            </div>
            <div class="regist5left1">
              <label> 手机号：</label>
              <input type="text" id="phone" placeholder="手机号" />
            </div>
            <!--验证码 -->
            <div class="regist5left1">
              <label> 验证码：</label>
              <input type="text" class="ipt_vry" name="ipt_vry" placeholder="验证码" />
              <input type="button" id='r_checkCode' class="pro_vry" name="pro_vry" value="" onclick="initCode()">
            </div>
          </div>
          <div class="regist5right">
            <!--头像-->
            <label> 请选择你的头像：</label>
            <div class="regist5photo" id="imgPreview">
              <img id="imghead" class="regist5PreImg">
            </div>
            <div class="regist5file">
              <input type="file" onchange="previewImage(this)" id="fileupload">
            </div>
          </div>
          <!-- 注册-->
          <div class="regist5btn">
            <button class="dl" onclick="regist()">注册</button>
          </div>
        </div>

      </div>
    </div>

  </div>
  <div class="ibody">
    <header>
      <h1>天道酬勤——厚德载物</h1>
      <h2>天行健，君子以自强不息；地势坤，君子以厚德载物。</h2>
      <div class="logo">
        <a href="/"></a>
      </div>
      <nav id="topnav">
        <a href="../index.html" id="topnav_current">首页</a>
        <a href="../about.html">关于我</a>
        <a href="../life.html" >慢生活</a>
        <a href="../share.html">在分享</a>
        <a href="../message.html">留言板</a>
        <a href="../manage.html" class="admin">管理员</a>
      </nav>
    </header>
    <article>
      <h2 class="about_h">您现在的位置是：
        <a href="../index.html">首页</a>>
        <a href="../index.html">文章</a>>
        <a href="../articlePages/military.html">国防军事</a>
      </h2>
      <div class="bloglist">
       
      </div>
    </article>
    <aside>
      <div class="rnav">
        <li class="rnav1 ">
          <a href="../articlePages/political.html">政治知事</a>
        </li>
        <li class="rnav2 ">
          <a href="../articlePages/military.html">国防军事</a>
        </li>
        <li class="rnav3 ">
          <a href="../articlePages/economic.html">经济论坛</a>
        </li>
        <li class="rnav4 ">
          <a href="../articlePages/culture.html">文化先锋</a>
        </li>
        <li class="rnav5 ">
          <a href="../articlePages/science.html">科学探索</a>
        </li>
        <li class="rnav6 ">
          <a href="../articlePages/sport.html">体育中心</a>
        </li>
      </div>
      <div class="ph_news">
        <h2>
          <p>点击排行</p>
        </h2>
        <ul class="ph_n">

        </ul>
        <h2>
          <p>栏目推荐</p>
        </h2>
        <ul class="tj_n">

        </ul>
       
        <h2>
          <p>最近访客</p>
          <ul class="recent-visitors-list" id="recentvisitorslist">
          </ul>
        </h2>
      </div>
      <div class="copyright">
        <ul>
          <p> Design by
            <a href="/">HC</a>
          </p>
          <p>皖ICP备17023783号</p>
          <p>Copyright © 2017 HC. All Rights Reserved.</p>
          </p>
        </ul>
      </div>
    </aside>
    <div class="clear"></div>
    <!-- 清除浮动 -->
  </div>
</body>
<script>
 var articleType = ["政治知事", "国防军事", "经济论坛", "文化先锋", "科学探索", "体育中心"];

$(document).ready(function () {
  clickRank();
  hotRank();
  statuFlush();
  recentVisitors();
  getMilitary();
});

// 点击排行
function clickRank() {
  $.ajax({
    type: "get",
    url: "/api/article/clickRank",
    dataType: "json",
    error: function () {
      toastr.err("最新数据获取失败！", "错误");
    },
    success: function (result) {
      if (result.statu == "success") {
        if (result.data.length > 0) {
          var data = result.data;
          var clickrank = $(".ph_news .ph_n");
          clickrank.html("");
          for (var i in data) {
            if (i == 0)
              clickrank.append("<li><span class='num1'>" + parseInt(parseInt(i) + 1) + "</span><a href='" +
                data[i].pageurl + "'>" + data[i].title + "</a></li>");
            if (i == 1)
              clickrank.append("<li><span class='num1'>" + parseInt(parseInt(i) + 1) + "</span><a href='" +
                data[i].pageurl + "'>" + data[i].title + "</a></li>");
            if (i == 2)
              clickrank.append("<li><span class='num1'>" + parseInt(parseInt(i) + 1) + "</span><a href='" +
                data[i].pageurl + "'>" + data[i].title + "</a></li>");
            if (i > 2)
              clickrank.append("<li><span>" + parseInt(parseInt(i) + 1) + "</span><a href='" + data[i].pageurl +
                "'>" + data[i].title + "</a></li>");
          }
        }
      } else {
        toastr.err(result.msg, "错误");
      }

    }
  });
}
// 栏目推荐
function hotRank() {
  $.ajax({
    type: "get",
    url: "/api/article/hotRank",
    dataType: "json",
    error: function () {
      toastr.err("推荐数据获取失败！", "错误");
    },
    success: function (result) {
      if (result.statu == "success") {
        if (result.data.length > 0) {
          var data = result.data;
          var hotrank = $(".ph_news .tj_n");
          hotrank.html("");
          for (var i in data) {
            hotrank.append("<li><a href='" + data[i].pageurl + "'>" + data[i].title + "</a></li>");
          }
        }
      } else {
        toastr.err(result.msg, "错误");
      }

    }
  });
}
//  最近访客
function recentVisitors() {
  $.ajax({
    type: "get",
    url: "/api/message/recentVisitors",
    dataType: "json",
    // data:{page:1},
    error: function () {
      toastr.err("最近访客数据获取失败！", "错误");
    },
    success: function (result) {
      if (result.statu == "success") {
        var visitors = document.getElementById("recentvisitorslist");
        for (var i in result.data) {
          if (result.data[i].loginAcount == "blog")
            visitors.innerHTML += "<img src='../" + result.data[i].ava + "' alt='" + result.data[i].name + "'>";
          else
            visitors.innerHTML += "<img src='" + result.data[i].ava + "' alt='" + result.data[i].name + "'>";
        }
      } else {
        toastr.err(result.msg, "错误");
      }
    }
  });
}
//  用户登陆状态检测
function statuFlush() {
  var userStatu = getCookie('loginStatu');
  if (userStatu) {
    if (userStatu == "qq") {
      document.getElementById("blogLoginStatu").style.display = 'none';
    }
    document.getElementById("login-regist").style.display = 'none';
    $("#login-regist").hide();
    var token = getCookie('token');
    $.ajax({
      type: "post",
      url: "/api/index/checkLogin",
      dataType: "json",
      data: {
        token: token
      },
      error: function () {
        toastr.error("账号状态出错！请重新登录。。。", "错误");
      },
      success: function (result) {
        if (result.statu == "err") {
          toastr.error("账号状态出错！请重新登录。。。", "错误");
          clearCookie('loginStatu');
          clearCookie('token');
          clearCookie('userava');
          clearCookie('username');
          clearCookie('identity');
        } else {
          if (userStatu == "blog") {
            var userdata = {
              name: getCookie("username"),
              ava: getCookie("userava")
            };
            createLoginData(userdata);
            var identity = getCookie("identity");
            if (parseInt(identity) < 3) {
              $(".admin").css({
                "display": "inline-block"
              });
            }
            setCookie("identity", identity, function () {
              return parseInt(identity);
            });

          }
        }
      }
    });

    // document.getElementById("login-regist").style.display = 'none';
  } else {
    document.getElementById("login-regist").style.display = 'block';
    document.getElementById("QQloginStatu").style.display = 'none';
    document.getElementById("blogLoginStatu").style.display = 'none';
  }
}
// 获取国防军事
function getMilitary() {
  $.ajax({
      type: "get",
      url: "/api/article/gettypedata",
      dataType: "json",
      data: {
        type: '1'
      },
      error: function () {
        toastr.err("点击量更新失败！", "错误");
      },
      success: function (result) {
        if (result.statu == "success") {
          var list = $(".bloglist");
          list.html("");
          var data = result.data;
          for (var i in data) {
            list.append("<div class='blogs' >"+ 
              "<h3>"+
              "<a href = '"+data[i].pageurl+"' > "+data[i].title+"</a>"+
              "</h3>"+
              "<figure >"+
              "<img src = '../"+data[i].imgurl+"' >"+
              "</figure>"+ 
              "<ul>"+
              "<p> "+data[i].content+"</p>"+
              "<a href = '"+data[i].pageurl+"' target = '_blank' class = 'readmore'> 阅读全文&gt;&gt;</a>"+
              "</ul>"+ 
              "<p class = 'autor'>"+
              "<span > 作者： "+data[i].author+" </span>"+ 
              "<span > 分类：【<a href = '"+data[i].pageurl+"'>"+articleType[parseInt(data[i].type)]+" </a>】</span>"+
              "<span > 浏览（ <a href = '"+data[i].pageurl+"'>"+data[i].clicknum+"</a>）</span>"+
              "<span > 评论（ <a href = '"+data[i].pageurl+"'>"+data[i].comments.length+"</a>）</span>"+
              "<span > 点赞（ <a href = '"+data[i].pageurl+"'>"+data[i].praise+"</a>）</span>"+
              "</p>"+
              "<div class='dateview'>"+data[i].time+"</div >"+
              "</div>");
            }

          }
        }
      });
  }
</script>
</html>